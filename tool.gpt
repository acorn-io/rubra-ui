tools: service, port, get-operating-system, open-file, open, start-file, start

!!Important!! -  A file can be local or remote.

Do all of the following in order and do not skip a step.
1. Run the service.
2. Get the port for the running service.
3. Get the operating system.
4. For the provided file, do one of the following two options:
    - If it is remote or starts with github.com, do not edit it.
    - If it is local, trim the directory from the file and remove the '.gpt' suffix.
5. Do one of the following options.
    - If the operating system is Windows:
        - If a file or URL is provided, use the start file tool.
        - If no file or URL is provided, use the start tool.
    - If the operating system is not Windows:
        - If a file or URL is provided, use the open-file tool.
        - If a file or URL is not provided, use the open tool.

---
name: service

#!sys.daemon /usr/bin/env npm run --prefix ${GPTSCRIPT_TOOL_DIR} dev

---

name: port
tools: service
description: Get the port for the running service

#!http://service.daemon.gptscript.local/api/port

---

name: get-operating-system

#!/usr/bin/env python3

import platform

print(platform.system())

---

name: open-file
arg: port: The port the service is listening on
arg: file: The file to open

#!/usr/bin/env sh

open http://localhost:${PORT}/run?file=${FILE}

---

name: open
arg: port: The port the service is listening on

#!/usr/bin/env sh

open http://localhost:${PORT}

---

name: start-file
arg: port: The port the service is listening on
arg: file: The file to open

#!/usr/bin/env powershell.exe

start http://localhost:$env:PORT/run?file=$env:FILE

---

name: start
arg: port: The port the service is listening on

#!/usr/bin/env sh

open http://localhost:$env:PORT
